<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Satellite Path in Cesium</title>
  <script src="https://cesium.com/downloads/cesiumjs/releases/1.114/Build/Cesium/Cesium.js"></script>
  <link href="https://cesium.com/downloads/cesiumjs/releases/1.114/Build/Cesium/Widgets/widgets.css" rel="stylesheet">
  <style>
    html, body, #cesiumContainer {
      width: 100%; height: 100%; margin: 0; padding: 0; overflow: hidden;
    }
  </style>
</head>
<body>
  <div id="cesiumContainer"></div>
  <script>
    Cesium.Ion.defaultAccessToken = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiI1ODczMDNmNS0xYmVkLTRlN2MtOGU2OC0wZmJjZThkODRiYjEiLCJpZCI6MzEwNjA1LCJpYXQiOjE3NDk0ODIyMDJ9.N3NlZUef39D7v3fPB8ivk1sTA313cWC_YyIaJIzBc7E'
    // Initialize Cesium viewer
    const viewer = new Cesium.Viewer('cesiumContainer', {
      timeline: true,
      animation: true
    });

    //cache buster
    const cacheBuster = '?t=' + new Date().getTime();
    viewer.dataSources.removeAll();
    // Load the CZML file
    viewer.dataSources.add(Cesium.CzmlDataSource.load('sats.czml' + cacheBuster))
      .then((dataSource) => {
        viewer.clock.shouldAnimate = true; // Start animating
      });

      // Set default view to encompass both ground stations
      viewer.camera.setView({
        destination: Cesium.Rectangle.fromDegrees(-108.5, 37.0, 100000)
      });

      viewer.entities.add({
        name: "Tx",
        position: Cesium.Cartesian3.fromDegrees(-104.876694, 39.587), // longitude, latitude, height (meters)
        cylinder: {
          length: 100000.0, // height of the cylinder in meters
          topRadius: 5000.0, // top radius in meters
          bottomRadius: 20000.0, // bottom radius in meters
          material: Cesium.Color.RED
        },
        label: {
          text: "Tx",
          font: "18px sans-serif",
          fillColor: Cesium.Color.WHITE,
          outlineColor: Cesium.Color.BLACK,
          outlineWidth: 2,
          style: Cesium.LabelStyle.FILL_AND_OUTLINE,
          verticalOrigin: Cesium.VerticalOrigin.BOTTOM,
          pixelOffset: new Cesium.Cartesian2(-30, -10) // Offset left and down
        }
      });

      viewer.entities.add({
        name: "Rx",
        position: Cesium.Cartesian3.fromDegrees(-104.6764, 39.8563), // longitude, latitude, height (meters)
        cylinder: {
          length: 100000.0, // height of the cylinder in meters
          topRadius: 5000.0, // top radius in meters
          bottomRadius: 20000.0, // bottom radius in meters
          material: Cesium.Color.RED
        },
        label: {
          text: "Rx",
          font: "18px sans-serif",
          fillColor: Cesium.Color.WHITE,
          outlineColor: Cesium.Color.BLACK,
          outlineWidth: 2,
          style: Cesium.LabelStyle.FILL_AND_OUTLINE,
          verticalOrigin: Cesium.VerticalOrigin.BOTTOM,
          pixelOffset: new Cesium.Cartesian2(30, -10) // Offset right and down
        }
      });

      // I would like to be able to draw lines when a sattelite crosses close enough to the rx and tx to say we're transmitting

  </script>
</body>
</html>
